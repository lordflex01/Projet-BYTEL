$existeABS = 0;
                $dateABS = [];
                
                //création de l'imput
                $imput->setUser($user);
                $imput->setCommentaire($donnees->tableauimput[$j]->Commentaires);
                $em = $this->getDoctrine()->getManager();
                $em->persist($imput);

                for($i=0; $i<5; $i++) {
                    $dateImputation = new DateTime($donnees->tableauimput[$j]->date[$i]);
                    $annee = $dateImputation->format('Y');
                    $dateImputVerif = $dateImputation->format('Y-m-d');

                    $collab = $userRepository->find($donnees->tableauimput[$j]->user);
                    $lieu = $collab->getSite();
                    $lieuArray = explode(', ',$lieu);
                    $pays = end($lieuArray);

                    $joursFeries = $this->getJoursFeries($pays, $annee);
                    // Condition pour voir si le jour d'imputation tombe un jour férié
                    if (array_key_exists($dateImputVerif, $joursFeries)) {
                        $existeABS = 1;
                        $donnees->tableauimput[$j]->valeur[$i] = 0;
                        $dateABS[] = $donnees->tableauimput[$j]->date[$i];
                    }
        
                    //Création des données
                    $dateV = new DateV;
                    $dateV->setImput($imput);
                    $dateV->setValeur($donnees->tableauimput[$j]->valeur[$i]);
                    $dateV->setDate(new DateTime($donnees->tableauimput[$j]->date[$i]));
                    $dateV->setTache($tache);
                    $dateV->setCodeprojet($codeP);
                    $dateV->setActivite($activite);
                    $charge_imput += $donnees->tableauimput[$j]->valeur[$i];
                    $em->persist($dateV);
                }

                if($existeABS == 1) {
                    $imputs = new Imput;
                    // Création de l'absence
                    $imputs->setUser($user);
                    $imputs->setCommentaire("Férié");
                    $em = $this->getDoctrine()->getManager();
                    $em->persist($imputs);

                    $CodeAbsence = $codeProjetRepository->findCodeAbsence();
                    
                    $IDCode = $CodeAbsence->getId();
                    $domaine = $collab->getProjet()->getLibelle();
                    $TacheAbsence = $tachesrepository->findTacheAbsence($IDCode, $domaine);
                    $ActiviteAbsence = $activiteRepository->findActiviteAbsence();

                    foreach ($dateABS as $dABS) {
                        $dateV = new DateV;
                        $dateV->setImput($imputs);
                        $dateV->setValeur(1);
                        $dateV->setDate(new DateTime($dABS));
                        $dateV->setTache($TacheAbsence);
                        $dateV->setCodeprojet($CodeAbsence);
                        $dateV->setActivite($ActiviteAbsence);
                        $charge_imput += 1;
                    }
                    
                    $em->persist($dateV);
                }
